<script type="text/javascript">
  <%= render 'pages/edit_blocks_table_script.js'%>
</script>

<div>
  <div class="">
    <div class="form-group">
      <h3>
        Blocks
      </h3>
      <table class="table table-striped">
        <thead>
          <tr>
            <th>
              ID
            </th>
            <th>
              Title
            </th>
            <th>
              Type
            </th>
            <th>
              Position
            </th>
            <th>
              Location
            </th>
            <th>

            </th>
          </tr>
        </thead>
        <tbody>
          <% @page.website.blocks.each do |block| %>
            <tr id="block_<%=block.id%>">
              <td>
                <%= block.id %>
              </td>
              <td>
                <%= block.name %>
              </td>
              <td>
                <%= block.block_type %>
              </td>
              <td>
                <%= block.position %>
              </td>
              <td>
                <%= block.location %>
              </td>
              <td class="text-right">
                <%= link_to 'Edit', edit_block_path(block), remote: true %>
                <button ng-click="blocksCtrl.edit_block_modal(block)" type="button" name="button" class="btn btn-sm btn-info "><i class="fa fa-pencil"></i> Edit</button>
                <button ng-show="block.page_ids.indexOf(blocksCtrl.page_id)>-1" ng-click="block.remove_page_id=blocksCtrl.page_id;blocksCtrl.save_block(block)" type="button" name="button" class="btn btn-sm btn-danger "><i class="fa fa-remove"></i> Remove from page</button>
                <button ng-hide="block.page_ids.indexOf(blocksCtrl.page_id)>-1" ng-click="block.add_page_id=blocksCtrl.page_id;blocksCtrl.save_block(block)" type="button" name="button" class="btn btn-sm btn-success "><i class="fa fa-plus"></i> Add to page</button>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <button type="button" class="btn btn-success" ng-click="blocksCtrl.edit_block_modal({website_id: <%= @page.website_id %>, page_ids: [<%= @page.id %>]})">
      New Page Block
    </button>
  </div>

</div>
